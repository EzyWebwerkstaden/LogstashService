input { 
	file {
		path => "C:/@Websites/test.mango.ezyserver.se/Logs/*.log"
		start_position => "end"
		exclude => ["*.txt", "NhibernateDatabaseOutput.log" ]
		type => "mangoweblog"
		debug => true
		codec => multiline {
			pattern => "^(?<datetime>[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3}) "
			negate => true
			what => previous
		}
	}
}
filter {
	mutate
	{
		gsub => ["message", "\n", "LINE_BREAK"]
	}
  grok {
	match => [ "message", "(?<timestamp>[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3}) (?<loglevel>\[[A-Z]*\]) (|- (?<source>.*) )- (?<ip>%{IPV4}|::1|UNKNOWN|NONE/UNKNOWN) - (?<locator>|[A-Za-z]{6}|.*) - %{GREEDYDATA:text}" ]
	type => "mangoweblog"
	
  }
  date {
	type => "mangoweblog"
	match => [ "timestamp", "yyyy-MM-dd HH:mm:ss,SSS" ]
	timezone => "Europe/Stockholm"
  }
}
output { 
	stdout {}
	elasticsearch { 
		cluster => "elasticsearch"
		host => "0.0.0.0"
		port => 9310
		index => "mangoweb"
		embedded => false
		flush_size => 100
		idle_flush_time => 2
	} 
}